plugins {
  id 'java'
  id 'groovy'
  id 'maven-publish'
  id 'signing'
  id "com.gradle.plugin-publish" version "0.20.0"
  id 'com.github.johnrengelman.shadow' version '7.1.2'
  id 'com.katalon.gradle-plugin' version '0.1.2'
}

group = 'com.coedotzmagic'
version = '1.1' 
description = 'Keywords Tools Testing for Katalon'

repositories {
  mavenCentral()
  maven { url 'https://plugins.gradle.org/m2/' }
  jcenter()
}

publishing {
    publications {
        mavenJava(MavenPublication) {
            from components.java
        }
    }
    repositories {
        maven {
            url = uri("https://s01.oss.sonatype.org/service/local/staging/deploy/maven2/")
        }
    }
}

signing {
    useGpgCmd()
    sign publishing.publications.mavenJava
}

pluginBundle {
  website = 'https://coedotzmagic.com/'
  tags = ['coedotzmagic']

  plugins {
    katalon {
      website = 'https://coedotzmagic.com/'
      displayName = 'CoedotzMagic QATools'
      description = 'Keywords Tools Testing for Katalon'
    }
  }
}

sourceSets {
   main {
    groovy {
      srcDirs = ['Keywords', 'Include/scripts/groovy']
      srcDir 'Libs' // generated by Katalon Studio
    }
  }
}

jar {
  exclude 'Temp*.class'
}

katalon {
  dependencyPrefix = "com.katalon"
  minimize = false
}

task generateJavadocs(type: Javadoc) {
  source = sourceSets.main.allJava
  classpath = sourceSets.main.compileClasspath
  destinationDir = file("${buildDir}/docs/javadoc")
}

build {
  dependsOn generateJavadocs
}

task javadocJar(type: Jar, dependsOn: generateJavadocs) {
  classifier = 'javadoc'
  from generateJavadocs.destinationDir
}

artifacts {
  archives javadocJar
}

dependencies {
  implementation fileTree(dir: 'libs', include: ['*.jar'])
}